# 系统设计中的容错性、高可用性、弹性和可靠性

另一个经常与**高可用性**一起出现的概念是**容错性**。这两个术语经常可以互换使用。当人们说一个容错系统时，他们的意思是一个高度可用的系统，反之亦然。我自己也经常这样做。然而，如果你深入文献，你会发现有人在解释它们之间的区别。我不能说我同意所有的论点，但我会解释其中的细微差别，让你自己决定。

## 术语解释

在此之前，先来一个简短的术语课。

- **错误（Error）**：一个错误，通常是由软件开发人员在编写程序时犯下的。
- **故障（Fault）**：程序中的缺陷，也称为漏洞或故障，导致系统行为不正确。错误可能导致故障。
- **失败（Failure）**：系统无法执行其所需功能。一个或多个故障可能导致系统失败。

一个**容错系统**知道如何隔离故障，使得故障不会导致整个系统的失败。

## 容错性 vs. 高可用性

那么，**高可用性**系统和**容错性**系统之间的区别是什么？

简而言之：

- **高可用性系统**接受可能会有停机时间的事实，并努力将其最小化。
- **容错系统**的目标是零停机时间。

根据这个定义，容错性就像是高可用性的升级版。如果系统是容错的，那么它也是高度可用的，而反之则不一定成立。

### 类比：汽车 vs. 飞机

用汽车和飞机的类比可能更容易理解这些细微差别。

- **汽车**：
  - 有一个备用轮胎。
  - 如果一个轮胎故障，我们可以停下来快速更换。
  - 有停机时间，但很短。
  - 把汽车想象成一个**高可用性系统**。
- **飞机**：
  - 在引擎故障时不能轻易停下来。
  - 其他引擎必须接管以确保零停机时间（直到下一次停靠）。
  - 飞机是一个**容错系统**。

## 设计容错系统

在设计容错系统时，我们应该应用之前为实现高可用性而提到的所有相同的设计原则和流程。唯一的区别是，实现容错可能需要超过通常实现高可用性所需水平的冗余资源，导致系统成本更高。

现在你知道了容错性和高可用性之间的区别。我认为这两个术语可以互换使用。高可用性是开放式的；我们希望系统的可用性有多高就有多高。当我们说系统是高度可用的，我们暗示它知道如何容忍故障。当我们说系统是容错的，我们暗示它保证最小的停机时间，按定义意味着一个高度可用的系统。

## 引入弹性

希望你的头脑还没被弄晕。如果没有，让我引入**弹性**这个术语。

在面对故障时，能够提供并维持可接受服务水平的系统称为**弹性系统**。听起来和容错性几乎一样，是吧？确实如此。这两个术语也经常可以互换使用。如果你在谷歌上搜索，你会发现一些资料解释了这些术语之间的细微区别。但坦率地说，我不想让你纠结于这些细微差别——它们并不那么重要。你还会在许多资料中遇到**Resiliency**这个词，它和Resilience（弹性）完全相同。这两个词是同一个名词的不同形式，所以随意使用其中任何一个。

为了确保系统具有弹性，我们需要故障的发生，因为我们希望不断地练习系统中引入的所有容错机制。这意味着我们可能想要故意生成故障——例如，定期杀死软件服务的随机实例。有一种称为**混沌工程**的技术，帮助模拟和测试各种系统故障。

### 混沌工程 vs. 游戏日

混沌工程可能会让你想起我们之前提到的**游戏日**流程。它们确实相似，但不完全相同。

- **游戏日**：
  - 主要关注**团队**及其行动。
  - 帮助团队建立如何应对事件的肌肉记忆。
- **混沌工程**：
  - 主要关注**系统行为**。
  - 目标是自动化实验，并在生产环境中持续运行它们。

当我们讨论分布式系统中的测试和运营卓越时，我们会在课程的后面回到这个话题。

## 可靠性

还有一个与可用性相关的概念——这是最后一个，我保证——就是**可靠性**。

简单来说，**可靠性**是：

- **高可用性**，加上
- **正确性**，加上
- **时间**

**正确性**意味着系统返回正确的结果，**时间**意味着系统在可接受的时间内回复。

在这里，正确性和时间都很重要。你可能有一个始终可用的系统，但由于频繁的数据损坏，它返回错误的结果，或者系统太慢，响应已不再有用。在这两种情况下，尽管我们有一个高度可用的系统，但它并不可靠。

## 综合起来

这里有一件有趣的事情。在之前的视频中，我们谈到了高可用性。在本视频中，我们讨论了可以被视为高可用性更强版本的容错性。然后我们介绍了与容错性几乎相同的弹性，以及高可用性加上正确性和时间的可靠性。所有这些术语彼此非常相似。

然而，你会听到人们在一句话中使用其中的多个术语。例如，有人可能会说她创建的系统是**可靠且具有弹性的**。这怎么可能？这不是同义反复吗？之所以发生这种情况，是因为这些术语虽然相似，但并不相同。它们有略微不同的含义，具体如下。

### 不同的含义

- **高可用性和可靠性**：
  - 系统处理**已知和预期故障**的能力。
  - 示例：服务器崩溃、数据中心断电、网络问题。
  - 通过称系统为可靠的，我们强调系统知道如何处理这些问题。

- **弹性**：
  - 系统处理**意外故障**的能力。
  - 示例：来自客户端的短期和长期流量激增、依赖项故障。
  - 通过称系统为具有弹性的，我们强调系统知道如何处理意外问题。

因此，通过称系统为**可靠且具有弹性的**，人们暗示他们的系统超级可靠。

同时，许多人选择不区分预期和意外的故障。通过称系统为**可靠的**，他们暗示系统可以处理两者。换句话说，弹性被认为是可靠性的必要组成部分。

## 结论

好了，我们已经讨论完了所有这些可用性、可靠性和弹性。我想明确一点：我们花这么多时间讨论所有这些术语，并不是因为我们是了解所有细微差别并想显得聪明的书呆子。关键是，所有这些概念都与可用性有关，当你的面试官要求你设计一个高度可用、容错、具有弹性或可靠的系统时，这都是关于我们应该使用的相同的一套原则和最佳实践。我们将涵盖其中的绝大部分。

下次你阅读或编写设计文档时，试着更多地关注这些术语是如何使用的。
